<!DOCTYPE html>
<html layout:decorate="~{layouts/layout}" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 minimum-scale=1, maximum-scale=1, shrink-to-fot=no">
    <title>Title</title>
    <link rel="stylesheet" th:href="@{/css/page_a.css/}">
</head>
<body>
    <div layout:fragment="content">
        <section class="side-s1">
            <div class="wrap">
                <p><a href="index.html">HOME</a> > <a href="sidemap.html">향수세트</a></p>
                <h1>향수세트</h1>
                <div class="boxs">
                    <div class="category">
                        <div class="category-top">
                            <h2>카테고리</h2>
                        </div>
                        <div class="category-bottom">
                            <ul>
                                <li><a href="#">여성용<span>(5)</span></a></li>
                                <li><a href="#">남성용</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="products-box">
                        <div class="title">
                            <ul>
                                <li><a href="#">신상품</a></li>
                                <li><a href="#">상품명</a></li>
                                <li><a href="#">클릭순</a></li>
                                <li><a href="#">베스트</a></li>
                                <li><a href="#">높은가격</a></li>
                                <li><a href="#">낮은가격</a></li>
                            </ul>
                        </div>
                        <form th:action="@{'/admin/items/' + ${items.number}}" role="form" method="get" th:object="${items}">
                        <div class="products">
                            <ul>
                                <li th:each="item, status:${items.getContent()}">
                                    <a th:href="'/admin/item/' +${item.id}">
                                    <div class="info">
                                        <p th:text="${item.itemNm}"></p>
                                        <b th:text="${item.price}"></b> <u th:text="${item.sale}+'%'"></u> <em th:text="${item.price} - ${item.price} * ${item.sale}/100"></em>
                                    </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                            <div th:with="start=${(items.number/maxPage)*maxPage + 1}, end=(${(items.totalPages == 0) ? 1 : (start + (maxPage - 1) < items.totalPages ? start + (maxPage - 1) : items.totalPages)})" >
                                <ul>

                                    <li th:classappend="${items.first}?'disabled'">
                                        <a th:onclick="'javascript:page(' + ${items.number - 1} + ')'" aria-label='Previous' class="page-link">
                                            <span aria-hidden='true'>Previous</span>
                                        </a>
                                    </li>

                                    <li th:each="page: ${#numbers.sequence(start, end)}" th:classappend="${items.number eq page-1}?'active':''">
                                        <a th:onclick="'javascript:page(' + ${page - 1} + ')'" th:inline="text" class="page-link">[[${page}]]</a>
                                    </li>

                                    <li th:classappend="${items.last}?'disabled'">
                                        <a th:onclick="'javascript:page(' + ${items.number + 1} + ')'" aria-label='Next' class="page-link">
                                            <span aria-hidden='true'>Next</span>
                                        </a>
                                    </li>

                                </ul>
                            </div>

                            <div th:object="${itemSearchDto}">
                                <select th:field="*{searchDateType}" style="width:auto;">
                                    <option value="all">전체기간</option>
                                    <option value="1d">1일</option>
                                    <option value="1w">1주</option>
                                    <option value="1m">1개월</option>
                                    <option value="6m">6개월</option>
                                </select>
                                <select th:field="*{searchSellStatus}" style="width:auto;">
                                    <option value="">판매상태(전체)</option>
                                    <option value="SELL">판매</option>
                                    <option value="SOLD_OUT">품절</option>
                                </select>
                                <select th:field="*{searchBy}" style="width:auto;">
                                    <option value="itemNm">상품명</option>
                                    <option value="createdBy">등록자</option>
                                </select>
                                <input th:field="*{searchQuery}" type="text" placeholder="검색어를 입력해주세요">
                                <button id="searchBtn" type="submit">검색</button>
                            </div>
                        </form>

                        </form>
                    </div>
                </div>
            </div>
        </section>
        <th:block layout:fragment="script">
            <script th:inline="javascript">

                $(document).ready(function(){
                    $("#searchBtn").on("click",function(e) {
                        e.preventDefault();
                        page(0);
                    });
                });

                function page(page){
                    var searchDateType = $("#searchDateType").val();
                    var searchSellStatus = $("#searchSellStatus").val();
                    var searchBy = $("#searchBy").val();
                    var searchQuery = $("#searchQuery").val();

                    location.href="/admin/items/" + page + "?searchDateType=" + searchDateType
                    + "&searchSellStatus=" + searchSellStatus
                    + "&searchBy=" + searchBy
                    + "&searchQuery=" + searchQuery;
                }

            </script>
        </th:block>
    </div>
</body>
</html>